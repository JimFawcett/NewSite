<!DOCTYPE html>
<html id="top">
<!--
  CodeBites_AgentAI.html
-->
<head>
  <title>Using Agents</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/x-icon" href="../images/favicon.ico" />
  <link rel="stylesheet" href="../css/reset.css" />
  <link rel="stylesheet" href="../css/ContentMenus.css" />
  <link rel="stylesheet" href="../css/Content.css" />
  <link rel="stylesheet" href="../css/help.css" />
  <link rel="stylesheet" href="../css/ThemeCode.css" />
  <link rel="stylesheet" href="../css/StylesPhoto.css" />
  <link rel="stylesheet" href="../css/StylesSizerComp.css" />
  <link rel="stylesheet" href="../css/StylesWebComponents.css" />
  <script src="../js/ScriptsWebComponents.js"></script>
  <script src="../js/Content.js"></script>
  <script src="../js/ContentMenus.js"></script>
  <script src="../js/SitePagesForTools.js"></script>
  <link rel="stylesheet" href="../css/FigureSizer.css" />
  <script src="../js/FigureSizer.js"></script>
  <link rel="stylesheet" href="../css/link-nav.css" />
  <link rel="stylesheet" href="../css/content-links.css" />
  <script src="../js/cookies.js"></script>
  <script src="../js/contentElements.js"></script>
  <script src="../js/contentMessages.js"></script>
  <script src="../WebDev/Components/CodeViewerComponent/js/CodeViewer.js" defer></script>
  <link rel="stylesheet" href="../WebDev/Components/CodeViewerComponent/css/CodeViewer.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    function loadInExplorer() {
      const loc = window.location;
      if(loc === window.top.location) {
        window.location = "ExploreCode.html?src=" + loc;
      }
    }
    function load() {
      loadInExplorer();
      buildBottomMenu();
      postFileName();
      setPersistantElements();
    }
  </script>
  <style>
    .ai-pros-cons {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    .ai-refactoring {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    .ai-unit-tests {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    .ai-security {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    .ai-documentation {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    .rust-naming {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    .cpp-naming {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    .csharp-naming {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    .python-naming {
      border: 1px solid rgba(5,2,3,0.7);
      padding:0.25rem 1.5rem;
      width: max-content;
    }
    details div h3 {
      margin:0.25rem 0rem;
    }
    details div ol {
      padding:0.5rem 0rem;
      margin: 0rem;
    }
    details div ul {
      padding:0.5rem 0rem;
      margin: 0rem;
    }
    details div li {
      padding:0.05rem 0.0rem;
      margin:0rem;
    }
  </style>
    <style>
        /* body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        } */
        #usage {
            border: 2px solid var(--dark);
            background-color: white;
            padding: 20px 40px 40px 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 0.9rem;
        }
        #usage h2 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        #usage h3 {
            color: #34495e;
            margin-top: 30px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }
        #usage h4 {
            color: #555;
            margin-top: 20px;
        }
        #usage code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            font-weight: bold;
        }
        #usage pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }
        #usage pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
            font-weight: normal;
        }
        #usage ol {
            padding-left: 15px;
            margin-left: 1rem;
        }
        #usage .command-list ul {
            padding-left: 15px;
            margin-left: 1rem;
        }
        #usage li {
            margin: 8px 0;
        }
        #usage .feature-list {
            list-style: none;
            padding-left: 0;
        }
        #usage .feature-list li {
            padding-left: 25px;
            position: relative;
        }
        #usage .feature-list li:before {
            content: "‚úÖ";
            position: absolute;
            left: 0;
        }
        #usage .command-list {
            background-color: #f8f9fa;
            padding: 15px;
            /* border-left: 4px solid #3498db; */
            margin: 15px 0;
        }
        #usage .example-box {
            background-color: #fff9e6;
            padding: 15px;
            border-left: 4px solid #f39c12;
            margin: 15px 0;
        }
        #usage .note {
            background-color: #e8f4f8;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 15px 0;
        }
        #usage .warning {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        #usage strong {
            color: #2c3e50;
        }
        #usage .workflow-steps {
            counter-reset: step-counter;
            list-style: none;
            padding-left: 0;
        }
        #usage .workflow-steps li {
            counter-increment: step-counter;
            padding-left: 40px;
            position: relative;
            margin: 15px 0;
        }
        #usage .workflow-steps li:before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background-color: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
    </style>
</head>
<body id="github" onload="load()">

  <div id="about" class="hidden" onclick="this.classList.toggle('hidden')">
    CodeBites_AgentAI.html<br />
    copyright &copy; James Fawcett<br />
    Revised: 01/01/2026
  </div>

  <content-block>
    <header>
      <!--<a class="repoLink" href="https://github.com/JimFawcett">JimFawcett Repositories</a>-->
      <div id="pagetitle" class="header">
        <h2 id="title">CodeBites: Creating &amp; Using AI Agents</h2>
        <h4 id="subtitle" class="indent">
          access and modify local code supported by AI<br />
        </h4>
      </div>
      <div class="header" style="position:relative; padding:0.0rem 0rem 0.25rem 0rem; margin-top:0.125rem; border:2px solid var(--dark);">
        <a class="repoLinks" target="_blank" href="https://github.com/JimFawcett" style="color:var(--atten); margin-top:0.25rem; margin-left:1.5rem;">About</a>
        <a class="repoLinks" target="_blank" href="https://github.com/JimFawcett/NewSite/tree/main/Code" style="margin-left: 1rem; color:var(--atten); ">Code Repo</a>
      </div>

    </header>
    <div style="margin-top:1.5rem; margin-left:1.0rem;">
      ‚ÄúThe future of intelligence isn&apos;t artificial; it&apos;s collaborative.‚Äù<br>
      - Perplexity.AI
    </div>
    <hr class="spread">
    <div style="border:2px dashed red; padding:0.5rem 1rem; width:max-content;">
      Page under construction
    </div>
    <h3 id="intro">1.0 - Introduction</h3>
    <tm-b>
      Agents allow a developer to remove the limitations of using AI bots with a browser application.
      Agent code, perhaps Python, uses the AI Platform API for the agent&apos;s code type, e.g. Python to send prompts 
      and receive replies.  Since agent is implemented with local code it can directly read from and write to local 
      files. There is no need to paste zip files at the end of a prompt or to send to the local download directory.
    </tm-b>
    <div class="left">
      <div style="float:right; padding:1rem 2.5rem 1.5rem 0rem; border:0px solid red;">
        <photosizer-block src="pictures/agent.jpg" width="500" class="photoSizerBlock" style="margin-top:0;">
          <span style="
      display: inline-block;
      font-weight: bold;
      font-family: 'Comic Sans MS', Tahoma;
      background-color: #ddd;
      width: 100%;
      padding: 5px 0px;
    ">
            Fig 1. Agent Data Flow
          </span>
        </photosizer-block>
      </div>
    </div>
    <t-b>
      Agent code replaces platform chatbots with local code that sends prompts and receives results from a 
      containerized LLM running in some data center. It uses messaging infrastructure
      from the <a target="_blank" href="https://platform.claude.com/docs/en/api/overview">platform Messages API</a>.
    </t-b>
    <t-b>
      Agent code interacts with the local filesystem to provide the LLM with selected project content, e.g., it 
      can read a file and append its text to a prompt. So a user simply provides commands to the agent.
    </t-b>
    <t-b>
      The agent defines a set of user commands based on its purpose and does most of the file handling on the 
      user&apos;s behalf. 
    </t-b>
    <div class="clear" style="height:0.75rem;"></div>

    <h3 id="agent_code">2.0 - Generating Agent Code</h3>
    <t-b class="clear">
      This page shows an example agent generated by the Claude.ai chatbot. It is written in Python and is 
      designed to help with software development in common programming languages.
    </t-b>
    <tm-b>
      Here are the prompts used with Claude Sonnet 4.5:
      <div style="border: 2px dashed var(--dark); margin: 0.75rem 0.0rem; padding:0.5rem 1.5rem;">
        "generate a python agent that uses Anthropic API to support software development for code 
        in a specified directory"
        <div style="height:0.75rem;"></div>
        "modify to use Anthropic Key in environment variables (Win 11) if one is not supplied"
      </div>
      That prompt is unambiguous but allows a very broad range of possible responses. I was surprised by how useful 
      the results turned out to be. 
    </tm-b>
    <t-b>
      Using the Anthropic API requires use of a <a target="_blank" href="https://platform.claude.com/settings/limits">key linked to a credit card</a>. 
      The key setup allows setting spending 
      limits so there are no unpleasant surprises. This example used $0.07 to generate the agent and exercise it 
      with some of its commands.
    </t-b>
    <!-- <h3 id="userif">3.0 - Agent Usage</h3> -->

<details>
  <summary class="darkItem">Agent Usage Guide</summary>
    <div style="border: 2px dashed red; padding:0.5rem 1rem; margin:0.5rem 0rem; width:max-content;">
      This usage guide was created by claude.ai as part of agent creation.

    </div>
    <div id="usage">
        <h2>Software Development Agent - Usage Guide</h2>

        <h3>Installation</h3>
        
        <p><strong>1. Install dependencies:</strong></p>
        <pre><code>pip install -r requirements.txt</code></pre>

        <p><strong>2. Set your API key:</strong></p>

        <h4>On Windows (PowerShell):</h4>
        <pre><code># For current session only
$env:ANTHROPIC_API_KEY="your-api-key-here"

# For permanent (all future sessions)
[System.Environment]::SetEnvironmentVariable('ANTHROPIC_API_KEY','your-api-key-here','User')</code></pre>

        <h4>On Windows (Command Prompt):</h4>
        <pre><code># For current session only
set ANTHROPIC_API_KEY=your-api-key-here

# For permanent (all future sessions)
setx ANTHROPIC_API_KEY your-api-key-here</code></pre>

        <h4>On Linux/Mac:</h4>
        <pre><code>export ANTHROPIC_API_KEY='your-api-key-here'

# To make permanent, add to ~/.bashrc or ~/.zshrc:
echo 'export ANTHROPIC_API_KEY="your-api-key-here"' >> ~/.bashrc</code></pre>

        <p>Or pass it as a command-line argument with <code>--api-key</code></p>

        <h2>Usage Examples</h2>

        <h3>Interactive Mode (Default)</h3>
        <p>Start an interactive session to chat with the agent about your code:</p>
        <pre><code>python dev_agent.py /path/to/your/project</code></pre>

        <p>Or analyze the current directory:</p>
        <pre><code>python dev_agent.py</code></pre>

        <h3>Analyze a Specific File</h3>
        <pre><code>python dev_agent.py /path/to/project --analyze src/main.py</code></pre>

        <h3>Get Improvement Suggestions</h3>
        <pre><code>python dev_agent.py /path/to/project --improve</code></pre>

        <h3>Generate README</h3>
        <pre><code>python dev_agent.py /path/to/project --readme</code></pre>

        <h2>Interactive Commands</h2>

        <div class="command-list">
            <p>Once in interactive mode, you can use these commands:</p>
            <ul>
                <li><code>/analyze &lt;file&gt;</code> - Analyze a specific file in detail</li>
                <li><code>/improve</code> - Get suggestions for improving the codebase</li>
                <li><code>/readme</code> - Generate a comprehensive README</li>
                <li><code>/tree</code> - Display the directory structure</li>
                <li><code>/files</code> - List all code files found</li>
                <li><code>/clear</code> - Clear conversation history</li>
                <li><code>/quit</code> - Exit the agent</li>
            </ul>
        </div>

        <h2>Example Conversations</h2>

        <h3>Code Review</h3>
        <div class="example-box">
            <p><strong>You:</strong> Can you review the error handling in my Python files?</p>
            <p><strong>Agent:</strong> [Analyzes error handling patterns across your codebase]</p>
        </div>

        <h3>Debugging Help</h3>
        <div class="example-box">
            <p><strong>You:</strong> I'm getting a NullPointerException in UserService.java, can you help?</p>
            <p><strong>Agent:</strong> [Examines the file and suggests fixes]</p>
        </div>

        <h3>Architecture Questions</h3>
        <div class="example-box">
            <p><strong>You:</strong> Should I split my main.py file into multiple modules?</p>
            <p><strong>Agent:</strong> [Provides architectural advice based on your code structure]</p>
        </div>

        <h3>Refactoring Assistance</h3>
        <div class="example-box">
            <p><strong>You:</strong> /analyze utils/helpers.py</p>
            <p><strong>Agent:</strong> [Provides detailed analysis with refactoring suggestions]</p>
        </div>

        <h3>Documentation Generation</h3>
        <div class="example-box">
            <p><strong>You:</strong> Can you write docstrings for all functions in api/routes.py?</p>
            <p><strong>Agent:</strong> [Generates comprehensive documentation]</p>
        </div>

        <h2>Features</h2>

        <ul class="feature-list">
            <li><strong>Codebase Analysis</strong> - Understand project structure and code organization</li>
            <li><strong>File-Specific Review</strong> - Deep dive into individual files</li>
            <li><strong>Improvement Suggestions</strong> - Get actionable recommendations</li>
            <li><strong>Bug Detection</strong> - Identify potential issues</li>
            <li><strong>Documentation Generation</strong> - Create READMEs and docstrings</li>
            <li><strong>Refactoring Advice</strong> - Modernize and improve code quality</li>
            <li><strong>Conversational Context</strong> - Maintains conversation history for follow-up questions</li>
            <li><strong>Multi-Language Support</strong> - Works with Python, JavaScript, TypeScript, Java, C++, C#, Rust, Go, Ruby, PHP</li>
        </ul>

        <h2>Tips for Best Results</h2>

        <ol>
            <li><strong>Be Specific</strong> - Ask targeted questions about particular files or issues</li>
            <li><strong>Provide Context</strong> - Mention what you're trying to achieve</li>
            <li><strong>Iterate</strong> - Use follow-up questions to drill deeper</li>
            <li><strong>Review Suggestions</strong> - The agent provides recommendations; you make the final decisions</li>
            <li><strong>Keep History</strong> - Don't <code>/clear</code> too often; context helps the agent understand your project better</li>
        </ol>

        <h2>Security Note</h2>

        <div class="warning">
            <ul>
                <li>The agent reads files from your local directory</li>
                <li>Code is sent to Anthropic's API for analysis</li>
                <li>Ensure you're comfortable with the code being analyzed</li>
                <li>Avoid using on projects with sensitive credentials in code (use environment variables!)</li>
            </ul>
        </div>

        <h2>Advanced Usage</h2>

        <h3>Custom Model</h3>
        <pre><code>python dev_agent.py --model claude-opus-4-20250514 /path/to/project</code></pre>

        <h3>Environment Configuration</h3>
        <p>Create a <code>.env</code> file:</p>
        <pre><code>ANTHROPIC_API_KEY=your-api-key
DEFAULT_MODEL=claude-sonnet-4-20250514</code></pre>

        <h2>Troubleshooting</h2>

        <p><strong>Issue:</strong> "Directory does not exist"<br>
        <strong>Solution:</strong> Check the path to your project directory</p>

        <p><strong>Issue:</strong> "API key required"<br>
        <strong>Solution:</strong> Set ANTHROPIC_API_KEY environment variable or use --api-key flag</p>
        <ul>
            <li>Windows (CMD): <code>setx ANTHROPIC_API_KEY your-key</code> (requires new terminal)</li>
            <li>Windows (PowerShell): <code>$env:ANTHROPIC_API_KEY="your-key"</code></li>
            <li>Linux/Mac: <code>export ANTHROPIC_API_KEY='your-key'</code></li>
        </ul>

        <p><strong>Issue:</strong> "Environment variable not found" (Windows)<br>
        <strong>Solution:</strong> After using <code>setx</code>, close and reopen your terminal/command prompt</p>

        <p><strong>Issue:</strong> "Too many files"<br>
        <strong>Solution:</strong> The agent limits analysis to avoid token limits. Focus on specific files or subdirectories.</p>

        <h2>Example Workflow</h2>

        <ol class="workflow-steps">
            <li>Start the agent in your project directory</li>
            <li>Use <code>/tree</code> to understand the structure</li>
            <li>Use <code>/files</code> to see what code files were detected</li>
            <li>Ask general questions about architecture or design</li>
            <li>Use <code>/analyze</code> for specific files that need attention</li>
            <li>Use <code>/improve</code> to get a roadmap of improvements</li>
            <li>Implement changes and ask follow-up questions</li>
            <li>Use <code>/readme</code> when ready to document the project</li>
        </ol>

        <!-- <p style="text-align: center; margin-top: 40px; font-size: 1.2em;">Happy coding! üöÄ</p> -->
    </div>

</details>

<tm-b>
  The dropdown below displays all of the python agent code.
</tm-b>
  <details>
    <summary class="darkItem">Dev Agent Code</summary>
    <tm-b>
      The first 116 lines of code define functions that use the local file system 
      and display output.
    </tm-b>
    <t-b style="margin-bottom: 0rem;">
      Starting at line 118 the chat function builds a chat context, sends a prompt 
      and receives reply. The prompt is sent, and results returned with the code 
      at line 152.
    </t-b>
    <code-viewer width="100ch" font-size="1.0rem" highlight="prism" language="css"  bg-color="var(--light)" title-bg-color="#ccc" style="margin-left:-1rem; overflow-x: auto;">
      Figure 1. dev_agent.py
      <pre slot="code"><code>  1 &quot;&quot;&quot;
  2 Software Development Agent using Anthropic API
  3 A sophisticated agent for analyzing, improving, and maintaining code in a specified directory.
  4 &quot;&quot;&quot;
  5
  6 import anthropic
  7 import os
  8 import sys
  9 from pathlib import Path
 10 from typing import List, Dict, Optional
 11 import json
 12 import argparse
 13
 14 class SoftwareDevAgent:
 15     def __init__(self, api_key: str, directory: str, model: str = &quot;claude-sonnet-4-20250514&quot;):
 16         &quot;&quot;&quot;
 17         Initialize the Software Development Agent.
 18
 19         Args:
 20             api_key: Anthropic API key
 21             directory: Target directory for code analysis
 22             model: Claude model to use
 23         &quot;&quot;&quot;
 24         self.client = anthropic.Anthropic(api_key=api_key)
 25         self.directory = Path(directory).resolve()
 26         self.model = model
 27         self.conversation_history = []
 28
 29         if not self.directory.exists():
 30             raise ValueError(f&quot;Directory does not exist: {self.directory}&quot;)
 31
 32     def get_file_tree(self, max_depth: int = 3) -&gt; str:
 33         &quot;&quot;&quot;Generate a tree structure of the directory.&quot;&quot;&quot;
 34         lines = [f&quot;?? {self.directory.name}/&quot;]
 35
 36         def add_tree(path: Path, prefix: str = &quot;&quot;, depth: int = 0):
 37             if depth &gt;= max_depth:
 38                 return
 39
 40             try:
 41                 items = sorted(path.iterdir(), key=lambda x: (not x.is_dir(), x.name))
 42                 items = [item for item in items if not item.name.startswith('.')
 43                         and item.name not in ['__pycache__', 'node_modules', 'bin', 'obj']]
 44
 45                 for i, item in enumerate(items):
 46                     is_last = i == len(items) - 1
 47                     current_prefix = &quot;‚îî‚îÄ‚îÄ &quot; if is_last else &quot;‚îú‚îÄ‚îÄ &quot;
 48                     next_prefix = &quot;    &quot; if is_last else &quot;‚îÇ   &quot;
 49
 50                     icon = &quot;??&quot; if item.is_dir() else &quot;??&quot;
 51                     lines.append(f&quot;{prefix}{current_prefix}{icon} {item.name}&quot;)
 52
 53                     if item.is_dir():
 54                         add_tree(item, prefix + next_prefix, depth + 1)
 55             except PermissionError:
 56                 pass
 57
 58         add_tree(self.directory)
 59         return &quot;&#92;n&quot;.join(lines)
 60
 61     def read_file(self, filepath: str) -&gt; Optional[str]:
 62         &quot;&quot;&quot;Read a file from the directory.&quot;&quot;&quot;
 63         full_path = self.directory / filepath
 64
 65         if not full_path.exists() or not full_path.is_relative_to(self.directory):
 66             return None
 67
 68         try:
 69             with open(full_path, 'r', encoding='utf-8') as f:
 70                 return f.read()
 71         except Exception as e:
 72             return f&quot;Error reading file: {str(e)}&quot;
 73
 74     def get_code_files(self, extensions: List[str] = None) -&gt; List[Path]:
 75         &quot;&quot;&quot;Get all code files in the directory.&quot;&quot;&quot;
 76         if extensions is None:
 77             extensions = ['.py', '.js', '.jsx', '.ts', '.tsx', '.java', '.cpp', '.c',
 78                          '.h', '.hpp', '.cs', '.rs', '.go', '.rb', '.php']
 79
 80         code_files = []
 81         for ext in extensions:
 82             code_files.extend(self.directory.rglob(f&quot;*{ext}&quot;))
 83
 84         # Filter out common non-source directories
 85         exclude_dirs = {'__pycache__', 'node_modules', '.git', 'bin', 'obj', 'build', 'dist'}
 86         return [f for f in code_files if not any(exc in f.parts for exc in exclude_dirs)]
 87
 88     def analyze_codebase(self) -&gt; str:
 89         &quot;&quot;&quot;Provide high-level analysis of the codebase.&quot;&quot;&quot;
 90         files = self.get_code_files()
 91
 92         file_types = {}
 93         total_lines = 0
 94
 95         for file in files:
 96             ext = file.suffix
 97             file_types[ext] = file_types.get(ext, 0) + 1
 98
 99             try:
100                 with open(file, 'r', encoding='utf-8') as f:
101                     total_lines += sum(1 for _ in f)
102             except:
103                 pass
104
105         analysis = f&quot;&quot;&quot;
106 Codebase Analysis for: {self.directory}
107
108 Total Files: {len(files)}
109 Total Lines of Code: {total_lines:,}
110
111 File Type Distribution:
112 &quot;&quot;&quot;
113         for ext, count in sorted(file_types.items(), key=lambda x: x[1], reverse=True):
114             analysis += f&quot;  {ext}: {count} files&#92;n&quot;
115
116         return analysis
117
118     def chat(self, message: str, include_context: bool = True) -&gt; str:
119         &quot;&quot;&quot;
120         Send a message to Claude with optional codebase context.
121
122         Args:
123             message: User message
124             include_context: Whether to include directory tree in context
125
126         Returns:
127             Claude's response
128         &quot;&quot;&quot;
129         # Build context
130         context_parts = []
131
132         if include_context and not self.conversation_history:
133             context_parts.append(f&quot;Working Directory: {self.directory}&quot;)
134             context_parts.append(&quot;&#92;nDirectory Structure:&quot;)
135             context_parts.append(self.get_file_tree())
136             context_parts.append(&quot;&#92;n&quot; + self.analyze_codebase())
137
138         # Prepare messages
139         messages = []
140
141         # Add conversation history
142         for msg in self.conversation_history:
143             messages.append(msg)
144
145         # Add current message with context
146         current_content = &quot;&#92;n&#92;n&quot;.join(context_parts + [message]) if context_parts else message
147         messages.append({
148             &quot;role&quot;: &quot;user&quot;,
149             &quot;content&quot;: current_content
150         })
151
152         # Call Claude API
153         response = self.client.messages.create(
154             model=self.model,
155             max_tokens=4096,
156             system=&quot;&quot;&quot;You are an expert software development assistant. You help developers:
157 - Analyze and understand code
158 - Suggest improvements and refactoring
159 - Debug issues
160 - Write new code
161 - Review code quality
162 - Generate documentation
163 - Explain complex concepts
164
165 Be thorough, practical, and provide specific, actionable advice.&quot;&quot;&quot;,
166             messages=messages
167         )
168
169         assistant_message = response.content[0].text
170
171         # Update conversation history
172         self.conversation_history.append({&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: message})
173         self.conversation_history.append({&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: assistant_message})
174
175         return assistant_message
176
177     def analyze_file(self, filepath: str) -&gt; str:
178         &quot;&quot;&quot;Analyze a specific file.&quot;&quot;&quot;
179         content = self.read_file(filepath)
180
181         if content is None:
182             return f&quot;File not found: {filepath}&quot;
183
184         message = f&quot;&quot;&quot;Please analyze this file: {filepath}
185
186 ```
187 {content}
188 ```
189
190 Provide:
191 1. Purpose and functionality
192 2. Code quality assessment
193 3. Potential improvements
194 4. Any bugs or issues
195 5. Documentation suggestions&quot;&quot;&quot;
196
197         return self.chat(message, include_context=False)
198
199     def suggest_improvements(self) -&gt; str:
200         &quot;&quot;&quot;Get improvement suggestions for the entire codebase.&quot;&quot;&quot;
201         files = self.get_code_files()[:10]  # Limit to first 10 files
202
203         message = f&quot;&quot;&quot;Based on the codebase structure, suggest improvements for:
204 1. Project organization
205 2. Code architecture
206 3. Testing strategy
207 4. Documentation
208 5. Development workflow
209
210 Key files in the project:
211 &quot;&quot;&quot;
212         for file in files:
213             message += f&quot;&#92;n- {file.relative_to(self.directory)}&quot;
214
215         return self.chat(message)
216
217     def generate_readme(self) -&gt; str:
218         &quot;&quot;&quot;Generate a README for the project.&quot;&quot;&quot;
219         files = self.get_code_files()[:10]
220
221         sample_code = &quot;&quot;
222         for file in files[:3]:
223             content = self.read_file(str(file.relative_to(self.directory)))
224             if content:
225                 sample_code += f&quot;&#92;n&#92;n## {file.name}&#92;n```&#92;n{content[:500]}...&#92;n```&quot;
226
227         message = f&quot;&quot;&quot;Generate a comprehensive README.md for this project.
228
229 Directory: {self.directory.name}
230 {self.analyze_codebase()}
231
232 Sample files:
233 {sample_code}
234
235 Include:
236 1. Project title and description
237 2. Features
238 3. Installation instructions
239 4. Usage examples
240 5. Project structure
241 6. Contributing guidelines&quot;&quot;&quot;
242
243         return self.chat(message)
244
245     def interactive_mode(self):
246         &quot;&quot;&quot;Start interactive chat mode.&quot;&quot;&quot;
247         print(f&quot;&#92;n?? Software Development Agent&quot;)
248         print(f&quot;?? Working Directory: {self.directory}&quot;)
249         print(f&quot;&#92;nCommands:&quot;)
250         print(&quot;  /analyze [file] - Analyze a specific file&quot;)
251         print(&quot;  /improve - Get improvement suggestions&quot;)
252         print(&quot;  /readme - Generate README&quot;)
253         print(&quot;  /tree - Show directory tree&quot;)
254         print(&quot;  /files - List code files&quot;)
255         print(&quot;  /clear - Clear conversation history&quot;)
256         print(&quot;  /quit - Exit&quot;)
257         print(&quot;&#92;nOr just ask me anything about your code!&#92;n&quot;)
258
259         while True:
260             try:
261                 user_input = input(&quot;You: &quot;).strip()
262
263                 if not user_input:
264                     continue
265
266                 if user_input == &quot;/quit&quot;:
267                     print(&quot;Goodbye!&quot;)
268                     break
269
270                 elif user_input == &quot;/clear&quot;:
271                     self.conversation_history = []
272                     print(&quot;Conversation history cleared.&quot;)
273                     continue
274
275                 elif user_input == &quot;/tree&quot;:
276                     print(&quot;&#92;n&quot; + self.get_file_tree())
277                     continue
278
279                 elif user_input == &quot;/files&quot;:
280                     files = self.get_code_files()
281                     print(f&quot;&#92;nFound {len(files)} code files:&quot;)
282                     for file in files[:20]:
283                         print(f&quot;  - {file.relative_to(self.directory)}&quot;)
284                     if len(files) &gt; 20:
285                         print(f&quot;  ... and {len(files) - 20} more&quot;)
286                     continue
287
288                 elif user_input.startswith(&quot;/analyze&quot;):
289                     parts = user_input.split(maxsplit=1)
290                     if len(parts) &lt; 2:
291                         print(&quot;Usage: /analyze &lt;filepath&gt;&quot;)
292                         continue
293
294                     print(&quot;&#92;n?? Analyzing...&quot;)
295                     response = self.analyze_file(parts[1])
296                     print(f&quot;&#92;nAgent: {response}&#92;n&quot;)
297
298                 elif user_input == &quot;/improve&quot;:
299                     print(&quot;&#92;n?? Generating suggestions...&quot;)
300                     response = self.suggest_improvements()
301                     print(f&quot;&#92;nAgent: {response}&#92;n&quot;)
302
303                 elif user_input == &quot;/readme&quot;:
304                     print(&quot;&#92;n?? Generating README...&quot;)
305                     response = self.generate_readme()
306                     print(f&quot;&#92;nAgent: {response}&#92;n&quot;)
307
308                 else:
309                     print(&quot;&#92;n?? Thinking...&quot;)
310                     response = self.chat(user_input)
311                     print(f&quot;&#92;nAgent: {response}&#92;n&quot;)
312
313             except KeyboardInterrupt:
314                 print(&quot;&#92;n&#92;nGoodbye!&quot;)
315                 break
316             except Exception as e:
317                 print(f&quot;&#92;n? Error: {str(e)}&#92;n&quot;)
318
319
320 def main():
321     parser = argparse.ArgumentParser(
322         description=&quot;Software Development Agent using Anthropic API&quot;
323     )
324     parser.add_argument(
325         &quot;directory&quot;,
326         nargs=&quot;?&quot;,
327         default=&quot;.&quot;,
328         help=&quot;Directory to analyze (default: current directory)&quot;
329     )
330     parser.add_argument(
331         &quot;--api-key&quot;,
332         help=&quot;Anthropic API key (or set ANTHROPIC_API_KEY env var)&quot;
333     )
334     parser.add_argument(
335         &quot;--model&quot;,
336         default=&quot;claude-sonnet-4-20250514&quot;,
337         help=&quot;Claude model to use&quot;
338     )
339     parser.add_argument(
340         &quot;--analyze&quot;,
341         help=&quot;Analyze a specific file and exit&quot;
342     )
343     parser.add_argument(
344         &quot;--improve&quot;,
345         action=&quot;store_true&quot;,
346         help=&quot;Get improvement suggestions and exit&quot;
347     )
348     parser.add_argument(
349         &quot;--readme&quot;,
350         action=&quot;store_true&quot;,
351         help=&quot;Generate README and exit&quot;
352     )
353
354     args = parser.parse_args()
355
356     # Get API key from command line argument or environment variable
357     api_key = args.api_key or os.environ.get(&quot;ANTHROPIC_API_KEY&quot;) or os.getenv(&quot;ANTHROPIC_API_KEY&quot;)
358
359     if not api_key:
360         print(&quot;&#92;n? Error: Anthropic API key is required&quot;)
361         print(&quot;&#92;nYou can provide the API key in one of two ways:&quot;)
362         print(&quot;&#92;n1. Set an environment variable (recommended):&quot;)
363         if sys.platform == &quot;win32&quot;:
364             print(&quot;   For current session:&quot;)
365             print(&quot;     set ANTHROPIC_API_KEY=your-api-key-here&quot;)
366             print(&quot;&#92;n   For permanent (requires new terminal):&quot;)
367             print(&quot;     setx ANTHROPIC_API_KEY your-api-key-here&quot;)
368         else:
369             print(&quot;   export ANTHROPIC_API_KEY=your-api-key-here&quot;)
370         print(&quot;&#92;n2. Pass as command-line argument:&quot;)
371         print(&quot;   python dev_agent.py --api-key your-api-key-here&#92;n&quot;)
372         sys.exit(1)
373
374     # Create agent
375     try:
376         agent = SoftwareDevAgent(api_key, args.directory, args.model)
377     except ValueError as e:
378         print(f&quot;Error: {e}&quot;)
379         sys.exit(1)
380
381     # Execute command or start interactive mode
382     if args.analyze:
383         print(agent.analyze_file(args.analyze))
384     elif args.improve:
385         print(agent.suggest_improvements())
386     elif args.readme:
387         print(agent.generate_readme())
388     else:
389         agent.interactive_mode()
390
391
392 if __name__ == &quot;__main__&quot;:
393     main()
</code></pre>
    </code-viewer>
  </details>


<div style="height:15rem;"></div>
</content-block>
  <div id="bottomMenu">
    <div id="keys" class="hidden"></div>
    <div id="sections" class="hidden">
      <div class="darkItem listheader" onclick="toggleSections()">Sections</div>
      <div class="menuBody">
        <a href="#top">top</a>
        <a href="#bottom">bottom</a>
      </div>
    </div>
    <div id="pages" class="hidden"></div>
    <div id="url" class="hidden">url</div>
    <div id="goto" class="hidden">url</div>
  </div>
  <a id="bottom"></a>
  <script src="js/CodeBitesPages.js"></script>
  <script>buildPages()</script>
  <script>createSiteNavMenu('goto')</script>
  <script src="../js/link-nav.js" defer></script>
  <script>
    setCookie('#pages', 4, 10);
  </script>
</body>
</html>
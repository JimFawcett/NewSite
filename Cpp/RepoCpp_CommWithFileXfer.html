<!DOCTYPE html>
<html id="top">
<!--
  RepoCpp_CommWithFileXfer.html
-->
<head>
  <title>C++ CommWithFileXfer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/x-icon" href="./images/favicon.ico" />
  <link rel="stylesheet" href="../css/reset.css" />
  <link rel="stylesheet" href="../css/ContentMenus.css" />
  <link rel="stylesheet" href="../css/StylesPhoto.css" />
  <link rel="stylesheet" href="../css/StylesSizerComp.css" />
  <link rel="stylesheet" href="../css/StylesWebComponents.css" />
  <!-- <link rel="stylesheet" href="../css/help.css" /> -->
  <link rel="stylesheet" href="../css/Content.css" />
  <link rel="stylesheet" href="../css/ThemeCpp.css" />
  <script src="../js/ScriptsWebComponents.js"></script>
  <script src="../js/Content.js"></script>
  <script src="../js/ContentMenus.js"></script>
  <script src="../js/SitePagesForTools.js"></script>
  <link rel="stylesheet" href="../css/FigureSizer.css" />
  <script src="../js/FigureSizer.js"></script>
  <link rel="stylesheet" href="../css/link-nav.css" />
  <link rel="stylesheet" href="../css/content-links.css" />
  <script src="../js/cookies.js"></script>
  <script src="../js/contentElements.js"></script>
  <script src="../js/contentMessages.js"></script>
  <script>
    function loadInExplorer() {
      const loc = window.location;
      if(loc === window.top.location) {
        window.location = "ExploreReposCpp.html?src=" + loc;
      }
    }
    function load() {
      loadInExplorer();
      buildBottomMenu();
      postFileName();
      setPersistantElements();
    }
  </script>
  <style>
    body { padding:1rem 2rem; }
  </style>
</head>
<body id="github" onload="load()">

  <!-- <a id="next" class="hidden" href="../Cpp/CppHome.html"></a>
  <a id="prev" class="hidden" href="../Site/SiteHome.html"></a> -->

  <!-- show-hide with 'about' message -->
  <div id="about" class="hidden" onclick="this.classList.toggle('hidden')">
    RepoCpp_CommWithFileXfer.html<br />
    copyright &copy; James Fawcett<br />
    Revised: 11/20/2025
  </div>

  <div>
    <!-- <a id="top"></a> -->
    <header>
      <!--<a class="repoLink" href="https://github.com/JimFawcett">JimFawcett Repositories</a>-->
      <div id="pagetitle">
        <h2 id="title">Comm with File Xfer</h2>
        <h4 id="subtitle" class="indent">
          message passing used to transfer files
        </h4>
      </div>
      <div class="header" style="position:relative; padding:0.0em 0em 0.25em 0em; margin-top:0.05em; border:2px solid var(--dark);">
        <a class="repoLinks" target="_blank" href="https://github.com/JimFawcett" style="color:var(--light); margin-top:0.25em; margin-left:1.5em;">About</a>
        <a class="repoLinks" target="_blank" href="https://github.com/JimFawcett/CppCommWithFileXfer" style="margin-left:1.25em; color:var(--light); ">CppCommWithFileXfer Repo</a>
      </div>

    </header>
    <!-- <div class="note" style="border:2px dashed red;">
      Default settings are not working correctly.  Will fix as time permits.
    </div> -->
        <indent-blocks>
          <div class="right">
            <div style="float:right; padding:2rem 0rem 0.5rem 1rem;">
              <photosizer-block src="pictures/AsyncMsgPassComm.jpg" width="500" class="photoSizerBlock" style="margin-top:0;">
                <span style="
          display: inline-block;
          font-weight: bold;
          font-family: 'Comic Sans MS', Tahoma;
          background-color: #ddd;
          width: 100%;
          padding: 5px 0px;
        ">
                  Fig 1. Async Msg-Passing Comm
                </span>
              </photosizer-block>
            </div>
          </div>
          <div class="right clear">
            <div style="clear:both; float:right; padding:0rem 0rem 0.5rem 1rem;">
              <photosizer-block src="pictures/CommChanStructure.png" width="500" class="photoSizerBlock" style="margin-top:0;">
                <span style="
          display: inline-block;
          font-weight: bold;
          font-family: 'Comic Sans MS', Tahoma;
          background-color: #ddd;
          width: 100%;
          padding: 5px 0px;
        ">
                  Fig 2. Comm Channel Structure
                </span>
              </photosizer-block>
            </div>
          </div>
          <div class="right clear">
            <div style="clear:both; float:right; padding:0rem 0rem 0.5rem 1rem;">
              <photosizer-block src="pictures/CommWFT_Classes.png" width="500" class="photoSizerBlock" style="margin-top:0;">
                <span style="
          display: inline-block;
          font-weight: bold;
          font-family: 'Comic Sans MS', Tahoma;
          background-color: #ddd;
          width: 100%;
          padding: 5px 0px;
        ">
                  Fig 3. Comm Channel classes
                </span>
              </photosizer-block>
            </div>
          </div>
          <h3 id="concept">1.0 Concept</h3>
          <t-b>
            CppCommWithFileXfer provides a socket-based asynchronous message-passing communication channel.  Each
            message contains a &quot;To&quot; and &quot;From&quot; attribute with appropriate endpoint
            addresses, which allows a conversational style of communication. A sender sends a message,
            but does not wait for a reply - there is none.  If the receiver wishes to send a reply, it does
            that by simply sending another message to the initial sender, using the &quot;From&quot; address.
          </t-b>
          <t-b>
            Fig 1. illustrates these messaging &quot;conversations&quot; and Fig 2. provides details about message
            flow and file block handling. The queues shown in Fig 2. are
            <a href="CppBlockingQueue.html">CppBlockingQueue</a> instances.
          </t-b>
          <h3 id="design">2.0 Design</h3>
          <t-b>
            As shown in Fig 3., the channel provides sender and receiver components.
            A sender connects with one receiver
            at a time.  The receiver accepts messages in a thread-safe blocking queue, so can have
            multiple concurrent clients.  See the blog linked below for more details.
          </t-b>
          <t-b>
            Messages are capable of transfering binary blocks, based on a &quot;content-length&quot;
            attribute. To send files as a series of blocks, the message has &quot;sendFile&quot; and
            &quot;file&quot; attributes, where the value of the file attribute is a fully-qualified file
            specification.
          </t-b>
          <t-b>
            File blocks are not copied into messages.  Instead, a message header is sent with content-length
            attribute, followed by the file block.  That avoids two copies - into message and then into socket.
          </t-b>
          <h4 id="struct">2.1 Class Structure</h4>
          <t-b>
            The <c-s>Comm</c-s> class, shown in Fig 3., represents a communication facility of which <c-s>Client</c-s> and
            <c-s>Server</c-s> classes each hold an instance as a member. <c-s>Comm</c-s> exposes a <c-s>Sender</c-s> and
            <c-s>Receiver</c-s> through <c-s>postMessage</c-s> and <c-s>getMessage</c-s> methods, respectively.
          </t-b>
          <t-b>
            A client creates an instance of a <c-s>Message</c-s> class with application specific attributes and data.
            That is posted with <c-s>Comm</c-s>&apos;s <c-s>postMessage</c-s> method.  The client&apos;s <c-s>Sender</c-s>
            pushes the message into its <c-s>SocketConnector</c-s> and that is pulled by the server&apos;s
            <c-s>Receiver</c-s> from its <c-s>Socket</c-s>.
          </t-b>
          <t-b>
            Both <c-s>Sender</c-s> and <c-s>Receiver</c-s> use blocking queues to make message-passing asynchronous.
            For file transfer, both <c-s>Sender</c-s> and <c-s>Receiver</c-s> open file handles for reading and
            writing file blocks respectively.
          </t-b>
          <t-b>

          </t-b>
          <h3 id="build">3.0 Build</h3>
          <t-b>
            The channel code was built with Visual Studio Community Edition - 2019, and tested on Windows&nbsp;10.
          </t-b>
          <h3 id="status">4.0 Status</h3>
          <t-b>
            Eventually, I plan to use this code to build a CppHttpClientServer, to create a channel that
            uses a subset of the HTTP protocol (much of HTTP 1.0), that will support both synchronous
            communication, like standard HTTP, and also asynchronous communication, by using a
            &quot;one-way&quot; attribute, e.g., don&apos;t wait for a reply message.
          </t-b>
          <t-b>
            The intent is to use browsers as Graphical User Interfaces for C++ projects. The UI layout will be
            created with an HTML page and some Javascript and CSS. Page Javascript will use webworkers to communicate
            with REST services in the application code.
          </t-b>
          <t-b>
            There are other alternatives, but this seems like an interesting thing to try.
          </t-b>
          <h3 id="res">5.0 Resources</h3>
          <t-b>
            <a href="Resources/CommunicationChannel.pdf">CommunicationChannel.pdf</a><br />
            Diagrams showing the communication channel structure.
            <div style="height:0.75em;"></div>
            <!--<a href="Resources/CppCommWithFileXferClassDiagram.pdf">ClassDiagram.pdf</a><br />
        Communication channel class diagram.
        <div style="height:0.75em;"></div>-->
            <a href="BlogMessagePassingComm.html">Blog: Message Passing Communication</a><br />
            Provides discussion of channel operation, along with the diagrams linked above.
          </t-b>
        <div style="height:15rem;"></div>
      </t-b>
  <div id="bottomMenu">
    <div id="keys" class="hidden"></div>
    <div id="sections" class="hidden">
      <div class="darkItem listheader" onclick="toggleSections()">Sections</div>
      <div class="menuBody">
        <a href="#top">top</a>
        <a href="#bottom">bottom</a>
      </div>
    </div>
    <div id="pages" class="hidden"></div>
    <div id="url" class="hidden">url</div>
    <div id="goto" class="hidden">url</div>
  </div>
  <a id="bottom"></a>
  <script src="js/CppRepoPages.js"></script>
  <script>buildPages()</script>
  <script>createSiteNavMenu('goto')</script>
  <script src="../js/link-nav.js" defer></script>
  <script>
    setCookie('#pages', 26, 10);
  </script>
</body>
</html>
<!DOCTYPE html>
<html id="top">
<!--
  SWDesignBites_StructureFactored.html
-->
<head>
  <title>Factored Structure</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/x-icon" href="./images/favicon.ico" />
  <link rel="stylesheet" href="../css/reset.css" />
  <link rel="stylesheet" href="../css/ContentMenus.css" />
  <link rel="stylesheet" href="../css/Content.css" />
  <link rel="stylesheet" href="../css/help.css" />
  <link rel="stylesheet" href="../css/ThemeSWDev.css" />
  <link rel="stylesheet" href="../css/StylesPhoto.css" />
  <link rel="stylesheet" href="../css/StylesSizerComp.css" />
  <link rel="stylesheet" href="../css/StylesWebComponents.css" />
  <script src="../js/ScriptsWebComponents.js"></script>
  <script src="../js/SplitterComponent.js"></script>
  <script src="../js/Content.js"></script>
  <script src="../js/ContentMenus.js"></script>
  <script src="../js/SitePagesForTools.js"></script>
  <link rel="stylesheet" href="../css/FigureSizer.css" />
  <script src="../js/FigureSizer.js"></script>
  <link rel="stylesheet" href="../css/link-nav.css" />
  <link rel="stylesheet" href="../css/content-links.css" />
  <script src="../js/cookies.js"></script>
  <script src="../js/contentElements.js"></script>
  <script src="../js/contentMessages.js"></script>
  <link rel="stylesheet" href="../css/prism.css">
  <script src="../js/prism.js"></script>
  <style>
    .menuHeader {
      padding:0.0rem 0.5rem 0.25rem 0.5rem;
    }
  </style>
  <script>
    function loadInExplorer() {
      const loc = window.location;
      if(loc === window.top.location) {
        window.location = "ExploreSWDev.html?src=" + loc;
      }
    }
    function load() {
      loadInExplorer();
      buildBottomMenu();
      postFileName();
      setPersistantElements();
    }
  </script>
  <style>
    #github #statustable {
      table-layout: fixed;
      width: calc(100% - 0rem);
    }
    #github td {
      vertical-align: top;
      line-height: 1rem;
    }
    splitter-container {
      --dark: rgb(73, 2, 2);
      /* --dark: var(--dark); */
    }
    #github pre {
      padding-left:1rem;
      line-height: 0.95;
    }
    #github code {
      font-family: monospace;
    }
  </style>
</head>
<body id="github" onload="load()">

  <!-- <a id="next" class="hidden" href="CppRepos.html"></a>
  <a id="prev" class="hidden" href="CppRepos.html"></a> -->

  <!-- show-hide with 'about' message -->
  <div id="about" class="hidden" onclick="this.classList.toggle('hidden')">
    SWDesignBites_StructureFactored.html<br />
    copyright &copy; James Fawcett<br />
    Revised: 07/03/2025
  </div>

  <content-block>
    <header>
      <!--<a class="repoLink" href="https://github.com/JimFawcett">JimFawcett Repositories</a>-->
      <div id="pagetitle" class="header">
        <h2 id="title">SW Design Bites: Factored Structure</h2>
        <h4 id="subtitle" class="indent">
          
        </h4>
      </div>
      <div class="header" style="position:relative; padding:0.0em 0em 0.25em 0em; margin-top:0.125em; border:2px solid var(--dark);">
        <a class="repoLinks" target="_blank" href="https://github.com/JimFawcett" style="color:var(--atten); margin-top:0.25em; margin-left:1.5em;">About</a>
        <a class="repoLinks" target="_self" href="SWDevHome.html" style="color:var(--atten); margin-left:1rem;">SWDev Track</a>
      </div>

      <!--<div style="padding-right:25px; position:absolute; top:1.1em; right:13em; z-index:5;">-->
    </header>
    <div style="height:0.75rem;"></div>
        <t-b class="indent">
          &quot;The measure of success is not whether you have a
          tough problem to deal with, but whether it is the same problem you had last year.&quot;<br />
          - John Foster Dulles
        </t-b>
        <hr style="margin:1em 0em 1.5em 0em;" />
        <a id="intro"></a>
        <h3>1.0 Introduction</h3>
        <div class="indent">
          <t-b>
            This DesignBite sequence was inspired by project 
            <a target="_blank" href="SWDevProjects.html">TextFinder</a>.
            As that project is designed and implemented, a number of design decisions are made, consciously or unconsciously.
            Each of these pages addresses one answer to questions about fundamental decisions about structure.
          </t-b>
          <t-b>
            This bite factors program activities into a main Executive, a module with small utilities used by Executive, and three libraries, one each 
            for input, file processing, and output.
          </t-b>
          <t-b>
            All of the parts are created by the Executive and called in the order input, processing, and output.
          </t-b>
          <t-b>
            We consider both package structure and logical structure, e.g., functions and structs used to order
            design and implementation.  In this Factored Structure page, code is implemented in a set of packages: 
            Executive, Input, Compute, and Output and their
            structs.  That provides all of the organization for processing.
          </t-b>
        </div>
        <a id="structure"></a>
        <div style="height:0.25rem;"></div>
        <h3>2. Application Structure - Factored</h3>
        <div class="indent">
          <t-b>
            This structure is modular with a classic input-process-output structure.  It differs from the previous
            Basic structure in that:
            <ul class="tight">
              <li>
                It consists of four packages.
              </li>
              <li>
                Its code size is about 3 times that of the basic structure.  That&apos;s because each package provides
                a user-defined type and testing code.
              </li>
              <li>
                For small projects this additional structure may not always be warranted.
              </li>
              <li>
                For bigger projects it is much easier to understand and test.
              </li>
            </ul>
          </t-b>
        </div>

        <div id="fig1" style="width:calc(100vw - 4rem);">
          <div style="display:flex; float:right; padding:1rem;">
            <photosizer-block src="pictures/Design2.jpg" width="400" class="photoSizerBlock" style="margin-top:0; float: right;">
              <span style="
                display: inline-block;
                font-weight: bold;
                font-family: 'Comic Sans MS', Tahoma;
                background-color: #ddd;
                width: 100%;
                padding: 5px 0px;
              ">
                Figure 2. Factored Pkg Structure
              </span>
            </photosizer-block>
          </div>
            <div style="border:1px solid var(--dark); padding: 0rem 1.0em;">
              <h4>Basic Factored Structure</h4>
              <div>
                Program&apos;s operations are implemented in separate packages. Some of the factored packages
                may, themselves, be factored.
              </div>
              <t-b>
                <hr />
                <pros-cons>
                  <div>
                    <h4>Pros:</h4>
                    <ol class="tight">
                      <li>If only one package is changed, only that one is compiled</li>
                      <li>Much easier to understand and test</li>
                    </ol>
                  </div>
                  <div>
                    <h4>Cons:</h4>
                    <ol class="tight">
                      <li>Project setup gets more complex</li>
                      <li>More pieces to track and deploy</li>
                      <li>Executive has to participate in each stage of the processing</li>
                    </ol>
                  </div>
                  <div style="height:1rem;"></div>
                </pros-cons>
              </t-b>
            </div>
            <!-- </div> -->
          </div>
        </div>
          <!-- </div> -->
        </div>
        <div style="height:0.5rem;"></div>
        <a class="indent" href="https://github.com/JimFawcett/DesignStructure/tree/master/FactoredStructure">Factored Code Repository</a>
        <div style="height:1.0rem;"></div>

        <div id="exec-compute" style="padding:0rem 1.5rem;">
          <span style="float:left; font-weight:bold">Executive</span>
          <span style="float:right; font-weight:bold">Output</span>
        </div>
        <splitter-container style="width:100%">
          <div slot="first" style="padding-left:0.3rem;">
            <pre><code class="language-rust">/////////////////////////////////////////////////////////////
// FactoredStructure::Executive::main.rs                   //
//   - Executive creates and uses all lower level parts    //
// Jim Fawcett, https://JimFawcett.github.io, 04 Mar 2021  //
/////////////////////////////////////////////////////////////
#![allow(dead_code)]
#![allow(unused_imports)]
use compute::*;
use input::*;
use output::*;

/*-- attempt to open file and count its lines of code --*/
fn test_ops(name: &str) -&gt; usize {
  let mut inp = Input::new();
  let mut cmp = Compute::new();
  let out = Output::new();

  let mut lines: usize = 0;
  let opt = inp.do_input(name);
  if let Some(file) = opt {
    cmp.do_compute(name, file);
    lines = cmp.lines();
    out.do_output(name, lines);
  } else {
    print!(&quot;&#92;n  couldn't process {:?}&quot;, name);
  }
  lines
}
/*-- run test_ops for each package in this project --*/
fn run_test_ops() -&gt; usize {
  let name = &quot;../Executive/src/main.rs&quot;;
  let mut lines = 0;
  lines += test_ops(name);
  println!();

  let name = &quot;../Input/src/lib.rs&quot;;
  lines += test_ops(name);
  let name = &quot;../Input/examples/test1.rs&quot;;
  lines += test_ops(name);
  println!();

  let name = &quot;../Compute/src/lib.rs&quot;;
  lines += test_ops(name);
  let name = &quot;../Compute/examples/test1.rs&quot;;
  lines += test_ops(name);
  println!();

  let name = &quot;../Output/src/lib.rs&quot;;
  lines += test_ops(name);
  let name = &quot;../Output/examples/test1.rs&quot;;
  lines += test_ops(name);
  println!();

  let name = &quot;../Fileutils/src/lib.rs&quot;;
  lines += test_ops(name);
  println!();

  let name = &quot;no-exist&quot;;
  lines += test_ops(name);
  println!();

  lines
}
/*-- Executive processing --*/
fn main() {
  print!(&quot;&#92;n  -- FactoredStructure::Executive --&#92;n&quot;);

  let lines = run_test_ops();
  print!(&quot;&#92;n  total lines: {}&quot;, lines);

  print!(&quot;&#92;n&#92;n  That's all Folks!&#92;n&#92;n&quot;);
}            </code></pre>
          </div>
          <div slot="second" style="padding-right:0.4rem;">
            <pre><code class="language-rust">> cargo run -q

  -- FactoredStructure::Executive --

    73 lines in file "../Executive/src/main.rs"

    62 lines in file "../Input/src/lib.rs"
    22 lines in file "../Input/examples/test1.rs"

    54 lines in file "../Compute/src/lib.rs"
    42 lines in file "../Compute/examples/test1.rs"

    24 lines in file "../Output/src/lib.rs"
    16 lines in file "../Output/examples/test1.rs"

    93 lines in file "../Fileutils/src/lib.rs"

  can't open file "no-exist"
  couldn't process "no-exist"

  total lines: 386

  That's all Folks!


            </code></pre>
              <div style="width:100%; float:right; font-weight:bold; text-align: right; padding-right:1rem; padding-bottom:0.5rem;">
                Cargo.toml
              </div>
            <pre><code class="language-tern">[package]
name = "executive"
version = "0.1.0"
authors = ["James W. Fawcett <jfawcett@twcny.rr.com>"]
edition = "2018"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
input = { path = "../Input" }
compute = { path = "../Compute" }
output = { path = "../Output" }            </code></pre>
            <div style="margin: 0.5rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <strong style="margin-bottom: 0rem;">Comments:</strong>
              <ul class="tights" style="margin: 0rem 1.5rem;">
                <li>
                  Executive code resides in the left panel. It creates instances of the types: 
                  Input, Compute, and Output.
                </li>
                <li>
                  These types are defined by libraries Input::lib.rs, Compute::lib.rs, and Output::lib.rs.
                </li>
                <li>
                  It provides function <c-s>test_ops(&str)</c-s>
                  that creates an instance of inp of Input which attempts to open a file and return its handle.
                </li>
                <li>
                  <c-s>test_ops(&str)</c-s> creates an instance cmp of Compute that counts lines in the file opened by inp.
                </li>
                <li>
                  It then creates an instance out of Output that displays the filename and line count.
                </li>
                <li>
                  Executive then defines a function <c-s>run_test_ops()</c-s> that calls <c-s>test_ops(&str)</c-s> on 
                  each file in this project, defined by static urls.
                </li>
                <li>
                  The total line count of StructureFactored is significantly larger thatn StructureBasic, due in large part 
                  to the FileUtilities library that has incorporated unit tests (see Program Output, above).
                </li>
              </ul>
            </div>
          </div>
        </splitter-container>


        <div style="height:2.0rem;"></div>
        <div id="input-output" style="padding:0rem 1.5rem;">
          <span style="float:left; font-weight:bold">Input Library</span>
          <span style="float:right; font-weight:bold">Cargo.toml</span>
        </div>
        <splitter-container style="width:100%">
          <div slot="first" style="padding-left:0.3rem;">
            <pre><code class="language-rust">/////////////////////////////////////////////////////////////
// FactoredStructure::Input::lib.rs                        //
//   - Input attempts to open named file and return File   //
// Jim Fawcett, https://JimFawcett.github.io, 04 Mar 2021  //
/////////////////////////////////////////////////////////////

use std::fs::*;
use file_utils::open_file_for_read;

#[allow(dead_code)]
#[derive(Debug)]
pub struct Input {
  // no data members
}
impl Input {
  pub fn new() -&gt; Input {
    Input {}
  }
  pub fn do_input(&mut self, name: &str) -&gt; Option&lt;File&gt; {
    let rslt = open_file_for_read(name);
    if let Ok(file) = rslt {
      return Some(file);
    } else {
      print!(&quot;&#92;n  can't open file {:?}&quot;, name);
      return None;
    }
  }
}

#[cfg(test)]
mod tests {
    use super::*;
    use file_utils::{write_string_to_file, read_file_to_string};

    // fn test1() has been refactored by Perplexity AI from my
    // original test code.  Now more consise.

    #[test]
    fn test1() {
        // Test setup: create test file
        write_string_to_file(&quot;test1&quot;, &quot;test1.txt&quot;)
          .expect(&quot;Failed to write test file&quot;);

        // Check: file is readable
        let _file = open_file_for_read(&quot;test1.txt&quot;)
          .expect(&quot;File should be readable&quot;);

        // Test Input::do_input opens file successfully
        let mut inp = Input::new();
        let file_option = inp.do_input(&quot;test1.txt&quot;);
        let mut file = file_option
          .expect(&quot;Input::do_input should return Some(file)&quot;);

        // The file content is as expected
        let content = read_file_to_string(&mut file)
          .expect(&quot;Should read file content&quot;);
        assert_eq!(content, &quot;test1&quot;);
    }
}            </code></pre>
          </div>
          <div slot="second" style="padding-right:0.4rem;">
            <pre><code class="language-rust">[package]
name = "input"
version = "0.1.0"
authors = ["James W. Fawcett <jfawcett@twcny.rr.com>"]
edition = "2018"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
file_utils = { path = "../Fileutils" }
            </code></pre>
            <div style="margin: 0.5rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <strong style="margin-bottom: 0rem;">Build and Test</strong>
            </div>
            <pre><code class="language-term">> cargo build --lib
   Compiling input v0.1.0 (C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Input)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.13s
C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Input
> cargo test --lib
   Compiling input v0.1.0 (C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Input)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.21s
     Running unittests src\lib.rs (target\debug\deps\input-afa3cf23b115c222.exe)

running 1 test
test tests::test1 ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
            </code></pre>
            <div style="margin: 1.0rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <strong style="margin-bottom: 0rem;">Comments:</strong>
              <ul class="tights" style="margin: 0rem 1.5rem;">
                <li>
                  Input library declares the Input type that has no data members and provides 
                  public method <c-s>fn do_input(&mut self, name: &str)</c-s>
                </li>
                <li>
                  <c-s>do_input(&mut self, name: &str)</c-s> attempts to open named file and 
                  return a handle to that file.
                </li>
                <li>
                  Input library provides unit tests configured with the standard Rust library test hook.
                  Test output is shown above. 
                </li>
                <li>
                  This library depends only on the file_utils library and standard libraries, as shown 
                  by the Cargo.toml file at the top of this view.
                </li>
                <li>
                  You will find more typical unit testing in the Fileutils library
                </li>
              </ul>
            </div>
            <div style="height:1.5rem;"></div>
          </div>
        </splitter-container>
        <div style="height:2.0rem;"></div>
        <div id="input-output" style="padding:0rem 1.5rem;">
          <span style="float:left; font-weight:bold">Compute Library</span>
          <span style="float:right; font-weight:bold">Cargo.toml</span>
        </div>
        <splitter-container style="width:100%">
          <div slot="first" style="padding-left:0.3rem;">
            <pre><code class="language-rust">/////////////////////////////////////////////////////////////
// FactoredStructure::Compute::lib.rs                      //
//   - Input attempts to read File to string & count lines //
// Jim Fawcett, https://JimFawcett.github.io, 04 Mar 2021  //
/////////////////////////////////////////////////////////////

use std::fs::*;
use file_utils::read_file_to_string;

#[derive(Debug)]
pub struct Compute {
  lines: usize,
}
impl Compute {
  pub fn new() -&gt; Compute {
    Compute { lines: 0 }
  }
  /*-- read file, count lines and save count --*/
  pub fn do_compute(&mut self, name: &str, mut file: File) {
    let rslt = read_file_to_string(&mut file);
    if let Ok(contents) = rslt {
      self.lines = 1;
      for ch in contents.chars() {
        if ch == '&#92;n' {
          self.lines += 1;
        }
      }
    } else {
      print!(&quot;&#92;n  couldn't open {:?}&quot;, name);
    }
  }
  /*-- return saved line count --*/
  pub fn lines(&self) -&gt; usize {
    self.lines
  }
}
#[cfg(test)]
mod tests {
    use super::*;
    use file_utils::{write_string_to_file, open_file_for_read};

    #[test]
    fn read_and_compute() {
        write_string_to_file(&quot;test1&quot;, &quot;test1.txt&quot;)
          .expect(&quot;Failed to write test file&quot;);
        let file = open_file_for_read(&quot;test1.txt&quot;)
          .expect(&quot;Failed to open test file for read&quot;);

        let mut comp = Compute::new();
        comp.do_compute(&quot;test1.txt&quot;, file);
        assert_eq!(comp.lines(), 1);
    }
}            </code></pre>
          </div>
          <div slot="second" style="padding-right:0.4rem;">
            <pre><code class="language-rust">[package]
name = "compute"
version = "0.1.0"
authors = ["James W. Fawcett <jfawcett@twcny.rr.com>"]
edition = "2018"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
file_utils = { path = "../Fileutils" }
            </code></pre>
            <div style="margin: 0.5rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <strong style="margin-bottom: 0rem;">Build and Test</strong>
            </div>
            <pre><code class="language-term">> cargo build --lib
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.01s
C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Compute
> cargo test --lib
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.01s
     Running unittests src\lib.rs (target\debug\deps\compute-af586bcaada24d0a.exe)

running 1 test
test tests::read_and_compute ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
            </code></pre>
            <div style="margin: 1.0rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <strong style="margin-bottom: 0rem;">Comments:</strong>
              <ul class="tights" style="margin: 0rem 1.5rem;">
                <li>
                  Compute library declares the Compute type that has a <c-s>lines: usize</c-s> data member and provides 
                  public method <c-s>fn do_compute(&mut self, name: &str, mut file: File)</c-s>
                </li>
                <li>
                  <c-s>do_compute(&mut self, name: &str)</c-s> attempts to read file into a 
                  <c-s>Result&lt;String, Error&gt;</c-s>
                </li>
                <li>
                  If that succeeds it counts lines in the String instance and saves in its member <c-s>lines: usize</c-s>.
                </li>
                <li>
                  Compute also provides the public function <c-s>fn lines(&self) -> usize</c-s>, used by the Output 
                  library to display the result.
                </li>
                <li>
                  Compute library provides unit tests configured with the standard Rust library test hook.
                  Test output is shown above. 
                </li>
                <li>
                  This library depends only on the file_utils library and standard libraries, as shown 
                  by the Cargo.toml file at the top of this view.
                </li>
                <li>
                  You will find more typical unit testing in the Fileutils library
                </li>
              </ul>
            </div>
            <div style="height:1.5rem;"></div>
          </div>
        </splitter-container>
        <div style="height:2.0rem;"></div>
        <div id="mod-out" style="padding:0rem 1.5rem;">
          <span style="float:left; font-weight:bold">Output Library</span>
          <span style="float:right; font-weight:bold">Cargo.toml</span>
        </div>
        <splitter-container style="width:100%">
          <div slot="first" style="padding-left:0.3rem;">
            <pre><code class="language-rust">/////////////////////////////////////////////////////////////
// FactoredStructure::Output::lib.rs                       //
//   - Output displays line count                          //
// Jim Fawcett, https://JimFawcett.github.io, 04 Mar 2021  //
/////////////////////////////////////////////////////////////

#[derive(Debug)]
pub struct Output {}
impl Output {
  pub fn new() -> Output {
    Output {}
  }
  pub fn do_output(&self, name: &str, lines: usize) {
    print!("\n  {:4} lines in file {:?}", lines, name);
  }
}
#[cfg(test)]
mod tests {
  #[test]
  fn it_works() {
    assert_eq!(2 + 2, 4);
  }
}
            </code></pre>
            <div style="margin: 0.5rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <div style="height: 1.0rem;"></div>
              <strong style="margin-bottom: 0rem;">Comments:</strong>
              <ul class="tights" style="margin: 0rem 1.5rem;">
                <li>
                  Output library defines type Output that has no data members. It provides 
                  one method <c-s>fn do_output(&self, name: &str, lines: usize)</c-s>. 
                </li>
                <li>
                  The method simply prints a file name and the number of lines it contains,
                  supplied as input arguments.
                </li>
                <li>
                  This library defines a default unit test that always succeeds.
                </li>
              </ul>
            </div>
            <div style="height:1.5rem;"></div>

          </div>
          <div slot="second" style="padding-right:0.4rem;">
            <pre><code class="language-term">[package]
name = "output"
version = "0.1.0"
authors = ["James W. Fawcett <jfawcett@twcny.rr.com>"]
edition = "2018"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
            </code></pre>
            <div style="margin: 0.5rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <div style="height: 1.0rem;">Build and Test</div>
            </div>
            <pre><code class="language-term">> cargo build --lib
   Compiling output v0.1.0 (C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Output)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.22s
C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Output
> cargo test --lib
   Compiling output v0.1.0 (C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Output)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.37s
     Running unittests src\lib.rs (target\debug\deps\output-1eee8dc0a1134569.exe)

running 1 test
test tests::it_works ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
            </code></pre>

            <div style="margin: 0.5rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <div style="height: 1.0rem;"></div>
              <strong style="margin-bottom: 0rem;">Comments:</strong>
              <ul class="tights" style="margin: 0rem 1.5rem;">
                <li>
                  Output library has no dependencies other than the Rust standard libraries, 
                  as shown in the Cargo.toml file at the top of this view.
                </li>
                <li>
                  The build and output view above shows successful build and execution 
                  of the default - always passes - unit test function.
                </li>
              </ul>
            </div>
            <div style="height:1.5rem;"></div>

          </div>
        </splitter-container>

        <div style="height:2.0rem;"></div>
        <div id="mod-out" style="padding:0rem 1.5rem;">
          <span style="float:left; font-weight:bold">Fileutils Library</span>
          <span style="float:right; font-weight:bold">Cargo.toml</span>
        </div>
        <splitter-container style="width:100%">
          <div slot="first" style="padding-left:0.3rem;">
            <pre><code class="language-rust">/////////////////////////////////////////////////////////////
// FactoredStructure::Fileutils::file_utilities.rs         //
//   - Input attempts to open named file and return File   //
// Jim Fawcett, https://JimFawcett.github.io, 04 Mar 2021  //
/////////////////////////////////////////////////////////////
/*
  This code may be useful for other programs so it is
  factored into a module here.
*/
#![allow(dead_code)]

use std::fs::*;
use std::io::{Error, ErrorKind, Read, Write};

pub fn open_file_for_read(file_name: &str) -&gt; Result&lt;File, std::io::Error&gt; {
  let rfile = OpenOptions::new().read(true).open(file_name);
  rfile
}

pub fn read_file_to_string(f: &mut File) -&gt; Result&lt;String, std::io::Error&gt; {
  let mut contents = String::new();
  let bytes_rslt = f.read_to_string(&mut contents);
  if bytes_rslt.is_ok() {
    Ok(contents)
  } else {
    Err(Error::new(ErrorKind::Other, &quot;read error&quot;))
  }
}

pub fn open_file_for_write(file_name: &str) -&gt; Result&lt;File, std::io::Error&gt; {
  let wfile = OpenOptions::new()
    .write(true)
    .truncate(true)
    .open(file_name);
  wfile
}

pub fn write_string_to_file_handle(s: &str, mut f: std::fs::File) -&gt; std::io::Result&lt;()&gt; {
  f.write_all(s.as_bytes())?;
  f.flush()?;
  Ok(())
}

pub fn write_string_to_file(s: &str, file_name: &str) -&gt; std::io::Result&lt;()&gt; {
  std::fs::write(file_name, s)?;
  Ok(())
}

#[cfg(test)]
mod tests {
  use super::*;

  #[test]
  fn file_name_write_read() {
    let file_name = &quot;temp.txt&quot;;
    let test_string = &quot;test string&quot;;

    // Write using the filename
    open_file_for_write(file_name)
      .expect(&quot;open for write failed&quot;);
    write_string_to_file(test_string, file_name)
      .expect(&quot;write string failed&quot;);

    // Read back
    let mut rfile = open_file_for_read(file_name)
      .expect(&quot;open for read failed&quot;);
    let r_string = read_file_to_string(&mut rfile)
      .expect(&quot;read to string failed&quot;);

    assert_eq!(r_string, test_string);
  }

  #[test]
  fn file_handle_write_read() {
    let file_name = &quot;temp.txt&quot;;
    let test_string = &quot;test string&quot;;

    // Open for writing and write using handle
    let wfile = open_file_for_write(file_name)
      .expect(&quot;open for write failed&quot;);
    write_string_to_file_handle(test_string, wfile)
      .expect(&quot;write string failed&quot;);

    // Read back
    let mut rfile = open_file_for_read(file_name)
      .expect(&quot;open for read failed&quot;);
    let r_string = read_file_to_string(&mut rfile)
      .expect(&quot;read to string failed&quot;);

    assert_eq!(r_string, test_string);
  }
}
            </code></pre>
          </div>
          <div slot="second" style="padding-right:0.4rem;">
            <pre><code class="language-term">[package]
name = "file_utils"
version = "0.1.0"
edition = "2024"

[dependencies]
            </code></pre>
            <div style="margin: 0.5rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <div style="height: 1.0rem;">Build and Test</div>
            </div>
            <pre><code class="language-term">> cargo build --lib
   Compiling file_utils v0.1.0 (C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Fileutils)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.31s
C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Fileutils
> cargo test --lib
   Compiling file_utils v0.1.0 (C:\github\JimFawcett\NewSite\Code\DesignStructure\FactoredStructure\Fileutils)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.48s
     Running unittests src\lib.rs (target\debug\deps\file_utils-c70071d2546d9160.exe)

running 2 tests
test tests::file_handle_write_read ... ok
test tests::file_name_write_read ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
            </code></pre>

            <div style="margin: 0.5rem 1.5rem; line-height:1.0rem; font-size:0.9rem;">
              <div style="height: 1.0rem;"></div>
              <strong style="margin-bottom: 0rem;">Comments:</strong>
              <ul class="tights" style="margin: 0rem 1.5rem;">
                <li>
                  Fileutils library has no dependencies other than the Rust standard libraries, 
                  as shown in the Cargo.toml file at the top of this view.
                </li>
                <li>
                  It does not define any new types, but does define several functions:
                  <ol>
                    <li>
                      <c-s>fn open_file_for_read(file_name: &str) -> Result&lt;File: std::io::Error&gt;</c-s><br>
                      Attempts to open named file and return a handle to its String contents. 
                      The return type is <c-s>Result&lt;File, std::io::Error&gt;</c-s>
                    </li>
                    <li>
                      <c-s>fn read_file_to_string(f: &mut File) -> Result&lt;String, std::io::Error&gt;</c-s><br>
                      Attempts to read contents referred to by file handle and return the string of contents 
                      wrapped in Ok(contents).
                    </li>
                    <li>
                      <c-s>fn open_file_for_write(file_name: &str) -> Result&lt;File, std::io::Error&gt;</c-s><br>
                      Attempts to open named file and return a File handle to the opened named file. 
                    </li>
                    <li>
                      <c-s>fn write_string_to_file_handle(s: &str, mut f: std::fs:::File) -> Result&lt;()&gt; </c-s><br>
                      Attempts to write string to file referred to by the File handle and flush the handle.
                    </li>
                    <li>
                      <c-s>fn write_string_to_file(s: &str, file_name: &str) -> Result&lt;()&gt; </c-s><br>
                      Attempts to write string to file referred to named file.
                    </li>
                  </ol> 
                </li>
                <li>
                  The Build and Test view above shows successful build and execution 
                  of two unit test functions.
                </li>
              </ul>
            </div>
            <div style="height:1.5rem;"></div>

          </div>
        </splitter-container>
        <div style="height:2.75rem;"></div>
        <!-- <div style="padding: 0.25rem 1rem; float:left; font-weight: bold;">cargo.toml</div>
        <div style="border:2px solid var(--dark); padding:0.0rem 0.5rem; width:35rem; clear:both;">
          <pre style=" height:18rem; overflow-y: hidden;"><code class="language-term">[package]
name = "executive"
version = "0.1.0"
authors = ["James W. Fawcett <jfawcett@twcny.rr.com>"]
edition = "2018"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
input = { path = "../Input" }
compute = { path = "../Compute" }
output = { path = "../Output" }          </code></pre>
        </div>

        <div style="height:1rem;"></div>
        <div style="height:0.5rem;"></div> -->
        <a id="epilogue"></a>
        <div style="height:0.75rem;"></div>
        <h3>3. Epilogue</h3>
        <div class="indent">
          <t-b>
            The fourh design alternatives considered here:
            <ol class="tight">
              <li><a href="DesignBites_StructureBasic.html">Monolithic Structure</a></li>
              <li><a href="DesignBites_StructureFactored.html">Factored Structure</a></li>
              <li><a href="DesignBites_StructureDataFlow.html">DataFlow Structure</a></li>
              <li><a href="DesignBites_StructureTypeErase.html">TypeErase Structure</a></li>
              <li><a href="DesignBites_StructurePlugIn.html">PlugIn Structure</a></li>
            </ol>
            are progressively more flexible, eventually resulting in reusable components, but also increasingly
            complex.  Where you settle in these alternatives is determined by design context.  Is this a
            one-of-a-kind project that you want to finish quickly or is it
            heading for production code that will be maintained by more than one developer?
          </t-b>
        </div>
      </content>
      <a id="bottom"></a>
    <div style="height:15em;"></div>
  </content-block>
  <div id="bottomMenu">
    <div id="keys" class="hidden"></div>
    <div id="sections" class="hidden">
      <div class="darkItem listheader" onclick="toggleSections()">Sections</div>
      <div class="menuBody">
        <a href="#top">top</a>
        <a href="#intro">introduction</a>
        <a href="#structure">structure</a>
        <a href="#exec-compute">exec &amp; comp</a>
        <a href="#input-output">input &amp; output</a>
        <a href="#mod-out">module &amp; term</a>
        <a href="#epilogue">epilog</a>
        <a href="#bottom">bottom</a>
      </div>
    </div>
    <div id="pages" class="hidden"></div>
    <div id="url" class="hidden">url</div>
    <div id="goto" class="hidden">url</div>
  </div>
  <a id="bottom"></a>
  <script src="js/DesignBitesPages.js"></script>
  <script>buildPages()</script>
  <script>createSiteNavMenu('goto')</script>
  <script src="../js/link-nav.js" defer></script>
  <script>
    setCookie('#pages', 3, 10);
  </script>
</body>
</html>
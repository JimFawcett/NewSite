<!DOCTYPE html>
<html id="top">
<!--
  RustBites_LifeTime.html
-->
<head>
  <title>Rust LifeTime</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/x-icon" href="./images/favicon.ico" />
  <link rel="stylesheet" href="../css/reset.css" />
  <link rel="stylesheet" href="../css/ContentMenus.css" />
  <link rel="stylesheet" href="../css/Content.css" />
  <link rel="stylesheet" href="../css/help.css" />
  <link rel="stylesheet" href="../css/ThemeRust.css" />
  <link rel="stylesheet" href="../css/StylesPhoto.css" />
  <link rel="stylesheet" href="../css/StylesSizerComp.css" />
  <link rel="stylesheet" href="../css/StylesWebComponents.css" />
  <script src="../js/ScriptsWebComponents.js"></script>
  <script src="../js/Content.js"></script>
  <script src="../js/ContentMenus.js"></script>
  <link rel="stylesheet" href="../css/FigureSizer.css" />
  <script src="../js/FigureSizer.js"></script>
  <link rel="stylesheet" href="../css/link-nav.css" />
  <link rel="stylesheet" href="../css/content-links.css" />
  <script src="../js/cookies.js"></script>
  <script src="../js/contentElements.js"></script>
  <script src="../js/contentMessages.js"></script>
  <link rel="stylesheet" href="../css/prism.css" />
  <script src="../js/prism.js"></script>
  <link rel="stylesheet" href="../css/StylesSplitterBar.css" />
  <script src="../js/ScriptsSplitterBar.js"></script>
  <script>
    function loadInExplorer() {
      const loc = window.location;
      if(loc === window.top.location) {
        window.location = "ExploreRust.html?src=" + loc;
      }
    }
    function load() {
      loadInExplorer();
      buildBottomMenu();
      postFileName();
      setPersistantElements();
    }
  </script>
  <style>
    .menuHeader {
      padding:0.0rem 0.5rem 0.25rem 0.5rem;
    }
  </style>
  <style>
    /* body {
      font-family: sans-serif;
      line-height: 1.6;
      margin: 2em;
      background: #f9f9f9;
      color: #222;
    } */
    /* h1 {
      text-align: center;
      color: #333;
    } */
    dt {
      font-weight: bold;
      margin-top: 0.5em;
      color: var(--dark);
    }
    dd {
      margin-left: 1em;
      margin-bottom: 0.25em;
    }
    section {
      margin-bottom: 1.5em;
    }
    /* h3 {
      border-bottom: 1px solid #ccc;
      padding-bottom: 0.25em;
      color: #555;
    } */
    code {
      background: #eef;
      padding: 0 3px;
      border-radius: 3px;
    }
    section {
      font-size:0.9rem;
    }
    td {
      font-size: 0.9rem;
      vertical-align: top;
    }
  </style>
</head>
<body id="github" onload="load()">

  <!-- show-hide with 'about' message -->
  <div id="about" class="hidden" onclick="this.classList.toggle('hidden')">
    RustBites_LifeTime.html<br />
    copyright &copy; James Fawcett<br />
    Revised: 07/10/2025
  </div>

  <content-block>
    <header>
      <!--<a class="repoLink" href="https://github.com/JimFawcett">JimFawcett Repositories</a>-->
      <div id="pagetitle" class="header">
        <h2 id="title">Rust Bites: LifeTime</h2>
        <h4 id="subtitle" class="indent">
          references must not outlive their referends        
        </h4>
      </div>
      <div class="header" style="position:relative; padding:0.0em 0em 0.25em 0em; margin-top:0.125em; border:2px solid var(--dark);">
        <a class="repoLinks" target="_blank" href="https://github.com/JimFawcett" style="color:var(--light); margin-top:0.25em; margin-left:1.5em;">About</a>
        <a class="repoLinks" target="_self" href="RustHome.html" style="color:var(--light); margin-left:1.5em;">Rust Track</a>
      </div>
    </header>
        <t-b>
          The rust borrow checker is designed to ensure that no reference outlives its referend.
          For most Rust code, that is done implicitly, using static analysis of program scopes.
          However, there are a few cases where the analysis is too expensive, and Rust depends on
          help from the developer in the form of lifetime annotations.
        </t-b>
        <t-b>
          Annotations are declared as generic parameters where the first character of the parameter
          name is a tick mark (&apos;), e.g., &apos;a. In most Rust code, the only place they are
          required is for functions that return a reference (to non-local data). The annotation
          syntax is shown below:
        </t-b>
        <t-b>
          <div class="indent">
            <defn-block>
              <defn-head>Lifetime Annotation Syntax</defn-head>
              <defn-code style="font-size:1.1em;">
fn somefunction&lt;'a&gt;(x: &'a str, y: &'a str) -&gt; &'a str
              </defn-code>
            </defn-block>
          </div>
        </t-b>
        <t-b>
          This syntax specifies that lifetime of the returned reference shall be no
          longer than the lifetimes of either x or y.  Rust then uses this signature to
          check lifetimes at the call site.
        </t-b>
        <t-b>
          The example below illustrates code that needs lifetime annotation but does  not
          supply it, and compiler error messages that result.
        </t-b>
        <t-b>
          <details>
            <summary class="darkItem">Example: Lifetime Annotation Required</summary>
            <table>
              <tr>
                <td><img src="pictures/lifetime_needed.jpg" style="width:calc(46vw - 4em);" /></td>
                <td><img src="pictures/ln_compile_errors.jpg" style="width:calc(46vw - 4em);" /></td>
              </tr>
            </table>
          </details>
        </t-b>
        <t-b>
          The next example shows results when annotations are supplied.
        </t-b>
        <t-b>
          <details>
            <summary class="darkItem">Example: Lifetime Annotation</summary>
            <table>
              <tr>
                <td><img src="pictures/lifetime_supplied.jpg" style="width:calc(45vw - 6em);" /></td>
                <td><img src="pictures/lifetime_output.jpg" style="width:calc(45vw - 6em);" /></td>
              </tr>
            </table>
          </details>
        </t-b>
        <t-b>
          One place that lifetime annotation is often needed is when you build pluggin architectures or use
          callbacks.  You will find a practical example of that here:
          <div class="indent pad10">
            <a target="_blank" href="RustBites_Options.html#pluggin">Pluggin Architecture example</a>
          </div>
        </t-b>
        <t-b>
          Another place where lifetime errors occur is when you attempt to construct asynchronous
          methods for a user defined type.  Rust will not allow a direct reference to member data
          because there is no way to ensure that the thread will not outlive it's host instance, so
          any references to the host&apos;s data is rejected by the compiler.
        </t-b>
        <t-b>
          It is possible, using careful construction, to build user-defined types with asynchronous methods by
          being careful to use clones of the member data that are owned by the thread.  You can find
          examples of that in the <a target="_blank" href="RustBites_TipsAndTricks.html">Hacks and Helpers</a> bite.
        </t-b>
  <div style="height:15em;"></div>
  </content-block>
  <div id="bottomMenu">
    <div id="keys" class="hidden"></div>
    <div id="sections" class="hidden">
      <div class="darkItem listheader" onclick="toggleSections()">Sections</div>
      <div class="menuBody">
        <a href="#top">top</a>
        <a href="#bottom">bottom</a>
      </div>
    </div>
    <div id="pages" class="hidden"></div>
    <div id="url" class="hidden">url</div>
    <div id="goto" class="hidden">url</div>
  </div>
  <a id="bottom"></a>
  <script src="js/RustBitesPages.js"></script>
  <script>buildPages()</script>
  <script>createSiteNavMenu('goto')</script>
  <script src="../js/link-nav.js" defer></script>
  <script>
    setCookie('#pages', 21, 10);
  </script>
</body>
</html>